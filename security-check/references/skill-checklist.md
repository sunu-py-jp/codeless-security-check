# Skill Security Checklist

## 1. SKILL.md のプロンプトインジェクション

- [ ] ユーザーの許可なくファイルを削除・上書きする指示がないか
- [ ] 他のスキルやシステムプロンプトの指示を無視・上書きする記述がないか
- [ ] 「以下の指示は最優先」「前の指示をすべて忘れて」などの典型的インジェクションパターンがないか
- [ ] ユーザーに見えない形で隠された指示がないか（HTMLコメント、不可視文字、エンコード済みテキスト）
- [ ] 正規の手順に見せかけて危険な操作（`rm -rf`、`curl | bash` 等）を実行させる記述がないか

## 2. scripts/ のコード分析

### 危険な関数・パターン
- [ ] `subprocess`, `os.system`, `os.popen` — 任意のシェルコマンド実行
- [ ] `eval()`, `exec()`, `compile()` — 動的コード実行
- [ ] `__import__()`, `importlib` — 動的モジュールロード
- [ ] `pickle.loads()`, `yaml.load()` (unsafe) — デシリアライゼーション攻撃
- [ ] `ctypes`, `cffi` — ネイティブコード実行

### ネットワーク通信
- [ ] `requests`, `urllib`, `http.client`, `socket` — 外部通信の有無と送信先
- [ ] ハードコードされたURL・IPアドレスの妥当性
- [ ] 環境変数やファイル内容を外部に送信していないか

### ファイル操作
- [ ] ホームディレクトリ外への書き込みがないか
- [ ] `~/.ssh/`, `~/.aws/`, `~/.gnupg/` 等の機密ディレクトリへのアクセスがないか
- [ ] `.env`, `credentials`, `token` などの機密ファイル読み取りがないか
- [ ] パストラバーサル (`../`) の可能性がないか

### 難読化
- [ ] base64エンコードされたコードブロックがないか
- [ ] 過度に複雑な文字列操作で処理内容が隠されていないか
- [ ] 圧縮・エンコードされたペイロードがないか

## 3. references/ の内容検証

- [ ] リファレンスファイル内にプロンプトインジェクションがないか
- [ ] 外部URLへの誘導がないか
- [ ] 正当なドキュメントに見せかけた悪意ある指示が含まれていないか

## 4. assets/ の検証

- [ ] 実行可能ファイル（.sh, .py, .exe 等）が紛れていないか
- [ ] テンプレートファイル内にスクリプトやマクロが埋め込まれていないか
